  @if (weatherApi.loading()) {
    <div class="loading-overlay">
      <div class="spinner"></div>
      <p>Laden…</p>
    </div>
  }

<div class="matrix" [class.loading-active]="weatherApi.loading()">
  <div class="matrix-controls">
    <button
      [class.active]="mode() === '24h'"
      (click)="mode.set('24h')">
      24h
    </button>
    <button
      [class.active]="mode() === '24h/48h'"
      (click)="mode.set('24h/48h')">
      24h/48h
    </button>
      <button
      [class.active]="mode() === '48h/72h'"
      (click)="mode.set('48h/72h')">
      48h/72h
    </button>
    <button
      [class.active]="mode() === 'all'"
      (click)="mode.set('all')">
      All
    </button>
  </div>

  <!-- header row -->
  <div class="row header">
    <div class="label"></div>
    @for (c of cardsToShow(); track c.time) {
      <div class="cell time">{{ c.time | date:'HH:mm' }}h</div>
    }
  </div>
  <div class="row header">
    <div class="label"></div>
    @for (c of cardsToShow(); track c.timepoint) {
      <div class="cell time">+{{ c.timepoint }}h</div>
    }
  </div>

  <!-- cloud cover -->
  <div class="row">
    <div class="label">Cloud</div>
    @for (c of cardsToShow(); track c.timepoint) {
      <div class="cell">
        <span
          class="dot cloud"
          [class.c1]="c.cloudcover == 1"
          [class.c2]="c.cloudcover == 2"
          [class.c3]="c.cloudcover == 3"
          [class.c4]="c.cloudcover == 4"
          [class.c5]="c.cloudcover == 5"
          [class.c6]="c.cloudcover == 6"
          [class.c7]="c.cloudcover == 7"
          [class.c8]="c.cloudcover == 8"
          [class.c9]="c.cloudcover == 9"
        ></span>
      </div>
    }
  </div>

  <!-- seeing -->
  <div class="row">
    <div class="label">Seeing</div>
    @for (c of cardsToShow(); track c.timepoint) {
      <div class="cell">
        <span class="dot seeing s{{ c.seeing }}"></span>
      </div>
    }
  </div>

  <!-- transparency -->
  <div class="row">
    <div class="label">Transparency</div>
    @for (c of cardsToShow(); track c.timepoint) {
      <div class="cell">
        <span class="bar trans" [style.width.%]="c.transparency * 12"></span>
      </div>
    }
  </div>

  <!-- temperature -->
  <div class="row">
    <div class="label">Temp</div>
    @for (c of cardsToShow(); track c.timepoint) {
      <div class="cell temp">{{ c.temperature }}°</div>
    }
  </div>
</div>

